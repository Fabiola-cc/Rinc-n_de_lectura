<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Books blog - React exercise</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel"> 
        import PropTypes from 'prop-types'

        const colors = {
            base: '#fff'
        }

        const Header = () => {
            const styles = {
                display: 'flex',
                backgroundColor: colors.base,
                height: '10vh',
                width: '98%',
                fontWeight: 'bold',
                fontSize: '60px',
                fontFamily: 'Palatino',
                borderRadius: '10px',
                padding: '10px',
                alignItems: 'center',
                justifyContent: 'center',
                textShadow: '2px 2px 4px rgba(0, 0, 0, 0.5)',
            }

            return (
                <header style={styles}>
                    Rincón de lectura
                </header>
            )
        }

        const Footer = () => {
            const styles = {
                display: 'flex',
                backgroundColor: colors.base,
                height: '5vh',
                width: '98%',
                fontWeight: '900',
                fontSize: '10px',
                fontFamily: 'Lato, sans-serif',
                borderRadius: '8px',
                padding: '10px',
                alignItems: 'center',
                justifyContent: 'center',
            }
            return (
                <footer style={styles}>
                    Copyright 2024 UVG
                </footer>
            )
        }

        const MenuContent = ({ book_title, genre }) => {
            const styles = {
                backgroundColor: colors.base,
                fontFamily: 'Baskerville',
                listStyle: 'none',
                fontSize: '12px',
                textAlign: 'left',
            }
            return (
                <li style={styles}>
                    <h3>{book_title}</h3>
                    <p>Género: {genre}</p>
                </li>
            )
        }

        MenuContent.propTypes = {
            book_title: PropTypes.string.isRequired,
            genre: PropTypes.string.isRequired,
        }

        const Post = ({ id, book_title, author, genre, sinopsis, comments }) => {
            const styles = {
                listStyleType: 'none',
                backgroundColor: colors.base,
                padding: '10px',
                boxShadow: '0 4px 8px rgba(0, 0, 0, 0.1)',
                marginBottom: '20px',
                borderRadius: '5px',
            }
            return (
                <li style={styles}>
                    <h1>{book_title}</h1>
                    <h3>Autor: {author}</h3>
                    <p>Sinópsis: {sinopsis}</p>
                    <p>Comentario: {comments}</p>
                </li>
            )
        }

        Post.propTypes = {
            id: PropTypes.number.isRequired,
            book_title: PropTypes.string.isRequired,
            author: PropTypes.string.isRequired,
            genre: PropTypes.string.isRequired,
            sinopsis: PropTypes.string.isRequired,
            comments: PropTypes.string.isRequired,
        }

        const Content = () => {
            //STYLES
            const styles = {
                display: 'flex',
                width: '98%',
            }

            const MenuStyles = {
                width: '25vw',
                backgroundColor: colors.base,
                padding: '10px',
                textAlign: 'center',
            }

            const OnlyPostStyles = {
                display: 'grid',
                gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',
                gap: '15px',
            }

            //FETCH CONTENT
            const [posts, setPosts] = React.useState([])

            const getPosts = async () => {
                const apiResponse = await fetch('https://api.tiburoncin.lat/22787/posts')
                const jsonPosts = await apiResponse.json()
                setPosts(jsonPosts)
            }

            React.useEffect(() => {
                getPosts()
            }, [])

            //WAITING LOGIC
            if (posts.length === 0) {
                return <div>Loading...</div>
            }

            //VISUALIZE
            return (
                <div style={styles}>
                    <ul style={MenuStyles}>
                        <h2>Contenido del blog:</h2>
                        {posts.map(({ id, book_title, genre }) => (
                            <MenuContent key={id} book_title={book_title} genre={genre} />
                        ))}
                    </ul>

                    <ul style={OnlyPostStyles}>
                        {posts.map(({ id, book_title, author, genre, sinopsis, comments }) => (
                            <Post key={id} id={id} book_title={book_title} author={author} genre={genre} sinopsis={sinopsis} comments={comments} />
                        ))}
                    </ul>
                </div>
            )
        }

        const App = () => {
            const styles = {
                width: '80vw',
                margin: '0 auto',
                display: 'flex',
                padding: '5px',
                flexDirection: 'column',
                alignItems: 'center',
                justifyContent: 'center',
                boxShadow: '0 4px 8px rgba(0, 0, 0, 0.1)',
            }

            return (
                <main style={styles}>
                    <Header />
                    <Content />
                    <Footer />
                </main>
            )
        }
        
        const root = ReactDOM.createRoot(document.getElementById('root'))
        root.render(<App />)

    </script>
</body>
</html>
